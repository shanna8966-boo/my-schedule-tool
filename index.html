<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">ol{margin:0;padding:0}table td,table th{padding:0}.c2{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Arial";font-style:normal}.c0{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c3{background-color:#ffffff;max-width:451.4pt;padding:72pt 72pt 72pt 72pt}.c1{height:11pt}.title{padding-top:0pt;color:#000000;font-size:26pt;padding-bottom:3pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:0pt;color:#666666;font-size:15pt;padding-bottom:16pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:20pt;color:#000000;font-size:20pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#000000;font-size:16pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:16pt;color:#434343;font-size:14pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:14pt;color:#666666;font-size:12pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}</style></head><body class="c3 doc-content"><p class="c0"><span class="c2">&lt;!DOCTYPE html&gt;</span></p><p class="c0"><span class="c2">&lt;html lang=&quot;zh&quot;&gt;</span></p><p class="c0"><span class="c2">&lt;head&gt;</span></p><p class="c0"><span class="c2">&lt;meta charset=&quot;UTF-8&quot; /&gt;</span></p><p class="c0"><span class="c2">&lt;title&gt;&#34892;&#31243;&#31649;&#29702;&#24037;&#20855; - Shanna &#29256;&lt;/title&gt;</span></p><p class="c0"><span class="c2">&lt;script src=&quot;https://cdn.jsdelivr.net/npm/chart.js&quot;&gt;&lt;/script&gt;</span></p><p class="c0"><span class="c2">&lt;/head&gt;</span></p><p class="c0 c1"><span class="c2"></span></p><p class="c0"><span class="c2">&lt;body style=&quot;font-family:Arial; max-width:700px; margin:auto; padding:40px;&quot;&gt;</span></p><p class="c0"><span class="c2">&lt;h2&gt;&#128197; &#34892;&#31243;&#31649;&#29702;&#24037;&#20855;&#65288;CSV &rarr; &#20170;&#26085;&#34892;&#31243;&#65291;&#20998;&#39006;&#22291;&#39173;&#22294;&#65289;&lt;/h2&gt;</span></p><p class="c0 c1"><span class="c2"></span></p><p class="c0"><span class="c2">&lt;input type=&quot;file&quot; id=&quot;fileInput&quot; accept=&quot;.csv&quot; /&gt;</span></p><p class="c0"><span class="c2">&lt;button onclick=&quot;processCSV()&quot;&gt;&#38283;&#22987;&#20998;&#26512;&lt;/button&gt;</span></p><p class="c0 c1"><span class="c2"></span></p><p class="c0"><span class="c2">&lt;hr&gt;</span></p><p class="c0 c1"><span class="c2"></span></p><p class="c0"><span class="c2">&lt;h3&gt;&#128204; &#20170;&#26085;&#34892;&#31243;&#34920;&lt;/h3&gt;</span></p><p class="c0"><span class="c2">&lt;div id=&quot;schedule&quot;&gt;&lt;/div&gt;</span></p><p class="c0 c1"><span class="c2"></span></p><p class="c0"><span class="c2">&lt;h3&gt;&#128202; &#20170;&#26085;&#20998;&#39006;&#22291;&#39173;&#22294;&lt;/h3&gt;</span></p><p class="c0"><span class="c2">&lt;canvas id=&quot;pieChart&quot;&gt;&lt;/canvas&gt;</span></p><p class="c0 c1"><span class="c2"></span></p><p class="c0"><span class="c2">&lt;script&gt;</span></p><p class="c0"><span class="c2">function processCSV() {</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; const file = document.getElementById(&quot;fileInput&quot;).files[0];</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; if (!file) return alert(&quot;&#35531;&#20808;&#19978;&#20659; CSV&quot;);</span></p><p class="c0 c1"><span class="c2"></span></p><p class="c0"><span class="c2">&nbsp; &nbsp; const reader = new FileReader();</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; reader.onload = function(e) {</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; const lines = e.target.result.split(&quot;\n&quot;).map(l =&gt; l.trim());</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; const today = new Date().toISOString().split(&quot;T&quot;)[0];</span></p><p class="c0 c1"><span class="c2"></span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; let events = [];</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; for (let i = 1; i &lt; lines.length; i++) {</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; const [date, start, end, title, category] = lines[i].split(&quot;,&quot;);</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (date === today) {</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; const duration = </span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (new Date(`${date}T${end}`) - new Date(`${date}T${start}`)) / 60000;</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; events.push({ start, end, title, category, duration });</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c0 c1"><span class="c2"></span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; // &#28210;&#26579;&#34892;&#31243;&#34920;</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; const scheduleDiv = document.getElementById(&quot;schedule&quot;);</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; scheduleDiv.innerHTML = &quot;&quot;;</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; events.forEach(ev =&gt; {</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; scheduleDiv.innerHTML += `</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;div&gt;</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;strong&gt;${ev.start} - ${ev.end}&lt;/strong&gt;&#65306;${ev.title}</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#65288;&#20998;&#39006;&#65306;${ev.category}&#65289;</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/div&gt;</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; `;</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; });</span></p><p class="c0 c1"><span class="c2"></span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; // &#35336;&#31639;&#20998;&#39006;&#27604;&#20363;</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; const categoryMap = {};</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; events.forEach(ev =&gt; {</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; categoryMap[ev.category] = (categoryMap[ev.category] || 0) + ev.duration;</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; });</span></p><p class="c0 c1"><span class="c2"></span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; const labels = Object.keys(categoryMap);</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; const dataValues = Object.values(categoryMap);</span></p><p class="c0 c1"><span class="c2"></span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; // &#29983;&#25104;&#22291;&#39173;&#22294;</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; new Chart(document.getElementById(&quot;pieChart&quot;), {</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; type: &quot;pie&quot;,</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; data: {</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; labels: labels,</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; datasets: [{</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; data: dataValues</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }]</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; });</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; };</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; reader.readAsText(file);</span></p><p class="c0"><span class="c2">}</span></p><p class="c0"><span class="c2">&lt;/script&gt;</span></p><p class="c0"><span class="c2">&lt;/body&gt;</span></p><p class="c0"><span class="c2">&lt;/html&gt;</span></p><p class="c0 c1"><span class="c2"></span></p><p class="c0 c1"><span class="c2"></span></p></body></html>